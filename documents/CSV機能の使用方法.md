# CSV機能の使用方法

## 概要
Gemini+ Chrome拡張機能では、カスタムメニューの管理を効率化するためのCSVエクスポート/インポート機能を提供しています。

## 機能の特徴

### エクスポート機能
- **全メニュー対応**: プリセットメニューとカスタムメニューの両方
- **フォルダ階層保持**: メニューの階層構造を保持
- **自動ファイル命名**: 日時付きファイル名の自動生成
- **UTF-8エンコーディング**: 日本語を含むメニューに対応

### インポート機能
- **既存メニュー保護**: 現在のメニューを壊さずに追加
- **重複回避**: 同名メニューの自動スキップ
- **エラーハンドリング**: 不正な行の警告とスキップ
- **フォルダ自動作成**: 必要に応じて新しいフォルダを作成

## 使用方法

### エクスポート手順
1. Chrome拡張機能のアイコンをクリック
2. 設定画面が開く
3. 右上のメニューボタン（⋯）をクリック
4. 「CSVエクスポート」を選択
5. 自動的にCSVファイルがダウンロードされる

**生成されるファイル名の例**:
```
gemini-plus-menus-2024-01-15-143022.csv
```

### インポート手順
1. Chrome拡張機能のアイコンをクリック
2. 設定画面が開く
3. 右上のメニューボタン（⋯）をクリック
4. 「CSVインポート」を選択
5. CSVファイルを選択してアップロード
6. インポート結果が表示される

## CSVファイル形式

### ヘッダー行
```csv
フォルダ,タイトル,プロンプト,適用範囲
```

### データ行の例
```csv
プリセット,サマリ,以下のページをサマリしてください：\n\nタイトル: {$TITLE}\nURL: {$URL}\n\nページの内容をサマリしてください。,both
カスタム,翻訳,以下のテキストを日本語に翻訳してください：\n\n{$TEXT},selection
インポート,校正,以下のテキストを校正してください：\n\n{$TEXT},both
```

### フィールド詳細

#### 1. フォルダ
- メニューを格納するフォルダ名
- 階層構造の場合: `親フォルダ/子フォルダ`
- 空白の場合: デフォルトフォルダに配置

#### 2. タイトル
- メニューの表示名
- 右クリックメニューに表示される名前

#### 3. プロンプト
- Geminiに送信されるプロンプトテンプレート
- 変数 `{$URL}`, `{$TITLE}`, `{$TEXT}` を使用可能
- 改行は `\n` で表現

#### 4. 適用範囲
- `both`: ページ全体と選択範囲の両方に適用
- `page`: ページ全体のみに適用
- `selection`: 選択範囲のみに適用

## 変数システム
プロンプト内で使用可能な変数：

| 変数 | 説明 | 例 |
|------|------|-----|
| `{$URL}` | 現在のページのURL | `https://example.com` |
| `{$TITLE}` | 現在のページのタイトル | `Example Page` |
| `{$TEXT}` | 選択されたテキスト or ページ全文 | `選択されたテキスト` |

## 注意事項

### エクスポート時
- 分割線（separator）は出力されません
- フォルダ階層は `/` で区切られます
- 特殊文字（カンマ、改行、引用符）は自動的にエスケープされます

### インポート時
- 同名のメニューは自動的にスキップされます
- 不正な行はエラーメッセージとともにスキップされます
- インポートされたメニューは「インポート」フォルダに配置されます

### CSVファイルの編集
- ExcelやGoogleスプレッドシートで編集可能
- 保存時は必ずCSV形式を選択
- 文字エンコーディングはUTF-8を推奨

## トラブルシューティング

### エクスポートが失敗する場合
- ポップアップブロッカーを無効にしてください
- ブラウザのダウンロード設定を確認してください

### インポートが失敗する場合
- CSVファイルの形式を確認してください
- 文字エンコーディングがUTF-8か確認してください
- 必須フィールド（タイトル、プロンプト）が空白でないか確認してください

### メニューが表示されない場合
- 右クリックメニューの更新には時間がかかる場合があります
- 拡張機能を再読み込みしてください
- ブラウザを再起動してください

## 活用例

### メニューのバックアップ
定期的にCSVエクスポートを実行して、メニューのバックアップを保存

### チーム間でのメニュー共有
CSVファイルを通じて、有用なプロンプトテンプレートをチーム間で共有

### 大量メニューの一括登録
スプレッドシートでメニューを作成し、CSVインポートで一括登録

### メニューの整理
CSVファイルを編集して、メニューの並び順やフォルダ構造を整理